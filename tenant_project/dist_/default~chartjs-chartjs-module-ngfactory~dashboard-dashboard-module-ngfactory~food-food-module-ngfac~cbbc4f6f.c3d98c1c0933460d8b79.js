(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{yHeE:function(t,e,s){"use strict";s.d(e,"a",function(){return f});var a=s("mrSG"),i=s("t/Na"),o=s("SbLv"),r=s("aR35"),n=s("NuUg"),c=s("v0/F"),u=s("uFtX"),h=s("mRTT"),p=s("K9Ia"),d=s("CcnG"),l=s("ZYCi"),f=function(){function t(t,e,s,a,o,n){this.http=t,this.auth=e,this.cookieService=s,this.pService=a,this.oService=o,this.router=n,this.companycashBackListUpdate=new p.a,this.vendorCashBackListUpdate=new p.a,this.userCashBackUpdate=new p.a,this.totalCostItemsUpdate=new p.a,this.grandTransactionTotal=0,this.accountTopUpHistoryIsLoaded=!1,this.inflowSum=0,this.listApiUrl="canteen/transaction/",this.listUrl=r.a.apiUrl+this.listApiUrl,this.listItems=[],this.voidTransactionListItems=[],this.noRefundVoidTransactionListItems=[],this.totalCostItems=[],this.totalCostSum=0,this.categoryQuantities=[],this.categoryQuantitiesB=[],this.categoryNames=[],this.balance=0,this.grandTotal=0,this.transactionCount=0,this.todaysTransactionCount=0,this.CountTransactionDaily=0,this.todaysStartStockCount=0,this.todaysEndStockCount=0,this.today="",this.currentMonthYear="",this.currentUserID=Number(this.cookieService.get("user_id")),this.currentUsername=this.cookieService.get("username"),this.transactionDetailApiUrl="canteen/transaction/",this.transactionDetailUrl=r.a.apiUrl+this.transactionDetailApiUrl+this.currentUserID+"/",this.isLoaded=!1,this.totalCostListIsLoaded=!1,this.topupHistoryLoaded=!1,this.isUploading=!1,this.todaysTransactions=[],this.todaysTransactionFoodNames=[],this.todaysTransactionFoodQuantities=[],this.companyTopupHistory=[{balance:0,date:"No Date Available"}],this.personalTopupHistory=[{balance:0,date:"No Date Available"}],this.uniquePaystackReference="",this.httpGETOptions={headers:new i.h({"Content-Type":"application/json",Accept:"application/json","X-CSRFToken":this.cookieService.get("csrftoken"),Authorization:"Bearer "+this.cookieService.get("buccaTokenAccess")})},this.httpNotGETOptions={headers:new i.h({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.cookieService.get("buccaTokenAccess")})}}return t.prototype.getTransactionsPerVendor=function(){return this.http.post(r.a.apiUrl+"canteen/teller/",this.pService.currentProfileID,this.httpNotGETOptions)},t.prototype.getDateFromString=function(t){return t.split(" ")[0]},t.prototype.getTimeFromString=function(t){return t.split(".")[0]},t.prototype.create=function(t){var e=this;this.isUploading=!0;var s={time:t.time,subject:t.subject,duration:t.duration,date:t.date,type:t.type,location:t.location,meetingRoom:t.meetingRoom,creatorStaffID:this.cookieService.get("user_id")};return this.http.post(r.a.apiUrl+"canteen/addtransaction/",s,this.httpNotGETOptions).subscribe(function(t){e.oService.basket=[]},function(t){})},t.prototype.cashout=function(t){var e=this;return this.http.post(r.a.apiUrl+"canteen/withdraw/",{ven_id:t},this.httpNotGETOptions).subscribe(function(t){e.pService.apiData.balance=0,alert("Congratulations!! your payment has been processed."),e.router.navigate(["dashboard"])},function(t){switch(t.status){case 401:e.auth.refreshJWT();break;case 500:alert("your request can not be processed at the moment, please try again later.")}})},t.prototype.companyCashout=function(){var t=this;return this.http.post(r.a.apiUrl+"canteen/withdraw_cmp/",{cmp_id:3},this.httpNotGETOptions).subscribe(function(e){alert("Congratulations!! your payment has been processed."),t.router.navigate(["dashboard"])},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.sidACashOut=function(){var t=this,e=this.cookieService.get("user_id");return this.http.post(r.a.apiUrl+"canteen/sid_transfer/",{user_id:e},this.httpNotGETOptions).subscribe(function(e){console.log(e),alert("Congratulations!! your payment has been processed."),t.router.navigate(["dashboard"])},function(e){switch(console.log(e),e.status){case 401:t.auth.refreshJWT()}})},t.prototype.resetCounters=function(){this.transactionCount=0},t.prototype.getBalance=function(){var t=this;if(!0===JSON.parse(this.cookieService.get("isComp")))return this.http.get(r.a.apiUrl+"canteen/company/"+this.cookieService.get("user_id")+"/",this.httpGETOptions).subscribe(function(e){t.balance=e.balance,t.cookieService.set("compName",e.name)},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getItems=function(){this.getBalance(),this.getTodaysDate(),this.topupHistoryLoaded=!1,this.cookieService.get("user_id");var t=JSON.parse(this.cookieService.get("isComp")),e=JSON.parse(this.cookieService.get("isStaff")),s=JSON.parse(this.cookieService.get("isVend"));this.getProfileData(),this.getFoodCategoryItems(),this.getTransactionListItems(),e?this.getUserTransactionItems(this.getTodaysDate()):t?this.getDaysTransactionItems(this.getTodaysDate()):s?this.getVendTransactionItems(this.getTodaysDate()):this.getDaysTransactionItems(this.getTodaysDate()),this.getDaysRevenue(),this.getCompanyListItems(),this.getUserListItems(),this.getDaysStartStock(this.getTodaysDate()),this.getDaysEndStock(this.getTodaysDate())},t.prototype.getTodaysDate=function(){var t,e,s=new Date;t=Number((s.getDate()+1+"").substring(1,2))>0?s.getDate():"0"+s.getDate(),e=Number(s.getMonth()+1)>9?s.getMonth()+1:"0"+(s.getMonth()+1);var a=s.getFullYear();return this.today=a+"-"+e+"-"+t,this.today},t.prototype.getTodaysMonth=function(){var t,e=new Date;Number((e.getDate()+1+"").substring(1,2)),e.getDate(),t=Number(e.getMonth()+1)>9?e.getMonth()+1:"0"+(e.getMonth()+1);var s=e.getFullYear();return this.today=s+"-"+t,this.currentMonthYear},t.prototype.getCompanyNameFromList=function(t){try{return this.companyListItems.find(function(e){return e.id===t}).name}catch(e){}},t.prototype.getCategoryNameFromList=function(t){try{return this.categories.find(function(e){return e.id===t}).name}catch(e){}},t.prototype.getUserNameFromList=function(t){return this.userListItems.find(function(e){return e.id===t}).firstname},t.prototype.getCompanyList=function(){return this.http.get(r.a.apiUrl+"canteen/company/",this.httpNotGETOptions)},t.prototype.getCompanyListItems=function(){var t=this;return this.getCompanyList().subscribe(function(e){t.companyListItems=e},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getFoodCategories=function(){return this.http.get(r.a.apiUrl+"canteen/category/",this.httpNotGETOptions)},t.prototype.getFoodCategoryItems=function(){var t=this;return this.getFoodCategories().subscribe(function(e){t.categories=e,t.categoryCount=0;for(var s=0;s<t.categories.length;s++)t.categoryCount++},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getMealCountPerCategory=function(t){var e=this;return this.http.post(r.a.apiUrl+"canteen/find/category/",{cat_id:t},this.httpNotGETOptions).subscribe(function(t){return a.b(e,void 0,void 0,function(){var e;return a.e(this,function(s){for(this.mealsPerCategory=0,e=0;e<t.length;e++)this.mealsPerCategory++;return this.categoryQuantities.push(this.mealsPerCategory),[2]})})},function(t){switch(t.status){case 400:alert(h.a.e400);break;case 401:alert(h.a.e401),e.auth.refreshJWT();break;case 403:alert(h.a.e403);break;case 404:alert(h.a.e404);break;case 413:alert(h.a.e413);break;case 415:alert(h.a.e415);break;case 500:alert(h.a.e500);break;case 503:alert(h.a.e503)}})},t.prototype.collectMealsPerCategory=function(){this.categoryQuantities=[];for(var t=0;t<this.categories.length;t++)this.getMealCountPerCategory(this.categories[t].id);return this.categoryQuantities},t.prototype.collectNamesOfCategories=function(){this.categoryNames=[];for(var t=0;t<this.categories.length;t++)this.categoryNames.push(this.categories[t].name);return this.categoryNames},t.prototype.getProfile=function(){var t=JSON.parse(this.cookieService.get("isComp")),e=this.cookieService.get("user_id");return this.currentUsername=this.cookieService.get("username"),t?this.http.get(r.a.apiUrl+"canteen/company/"+e+"/"):this.http.get(r.a.apiUrl+"canteen/profile/"+e+"/",this.httpNotGETOptions)},t.prototype.getProfileData=function(){var t=this;return this.getProfile().subscribe(function(e){t.profileData=e},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getUserList=function(){return this.http.get(r.a.apiUrl+"canteen/profile/",this.httpNotGETOptions)},t.prototype.getUserListItems=function(){var t=this;return this.getUserList().subscribe(function(e){t.userListItems=e},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getTransactionList=function(){return this.http.post(r.a.apiUrl+"canteen/all/transaction/",[{}],this.httpNotGETOptions)},t.prototype.getTransactionListItems=function(){var t=this;return this.getTransactionList().subscribe(function(e){if(!0===JSON.parse(t.cookieService.get("isStaff")))t.pService.getStaffDataItems(),t.grandTotal=0,t.transactionCount=0,e.filter(function(e){e.staff===t.pService.apiData.firstname&&(t.listItems.push(e),t.transactionCount++,t.grandTotal+=Number(e.total))});else if(!1===JSON.parse(t.cookieService.get("isStaff"))){t.listItems=e,t.grandTotal=0,t.transactionCount=0;for(var s=0;s<t.listItems.length;s++)t.transactionCount++,t.grandTotal+=Number(t.listItems[s].total)}t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getVoidTransactionList=function(){return this.http.get(r.a.apiUrl+"canteen/void/",this.httpNotGETOptions)},t.prototype.getVoidTransactionListItems=function(){var t=this;return this.isLoaded=!1,this.getVoidTransactionList().subscribe(function(e){t.voidTransactionListItems=e,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getNoRefundVoidTransactionList=function(){return this.http.get(r.a.apiUrl+"canteen/norefundvoid/",this.httpNotGETOptions)},t.prototype.getNoRefundVoidTransactionListItems=function(){var t=this;return this.isLoaded=!1,this.getNoRefundVoidTransactionList().subscribe(function(e){t.noRefundVoidTransactionListItems=e,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.countTransactionItems=function(){this.transactionCount=0;for(var t=0;t<this.listItems.length;t++)this.transactionCount++;return this.transactionCount},t.prototype.refreshApiUrl=function(){this.currentUserID=null,this.currentUsername=null,this.currentUserID=Number(this.cookieService.get("user_id")),this.currentUsername=this.cookieService.get("username"),this.transactionDetailUrl=r.a.apiUrl+this.transactionDetailApiUrl+this.currentUserID+"/"},t.prototype.getTransaction=function(){return this.http.get(this.transactionDetailUrl)},t.prototype.getTransactionDetails=function(){var t=this;return this.getTransaction().subscribe(function(e){return a.b(t,void 0,void 0,function(){return a.e(this,function(t){return this.transactionDetails=e,this.meetingCode=this.transactionDetails.meetingCode,this.time=this.transactionDetails.time,this.subject=this.transactionDetails.subject,this.duration=this.transactionDetails.duration,this.date=e.date,this.type=e.type,this.meetingRoom=e.meetingRoom,this.creatorStaffID=e.creatorStaffID,[2]})})},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getCompanyTopupHistory=function(){var t=this;return this.currentUserID=Number(this.cookieService.get("user_id")),this.topupHistoryLoaded=!1,this.http.post(r.a.apiUrl+"canteen/company/topup/history/",{user_id:this.currentUserID},this.httpNotGETOptions).subscribe(function(e){return a.b(t,void 0,void 0,function(){return a.e(this,function(t){return this.companyTopupHistory=e.reverse(),this.companyTopupHistory===[]&&(this.companyTopupHistory=[{topup:0,topup_date:"No Data Available"}]),this.topupHistoryLoaded=!0,[2]})})},function(e){switch(t.topupHistoryLoaded=!1,e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getPersonalTopupHistory=function(){var t=this;return this.currentUserID=Number(this.cookieService.get("user_id")),this.topupHistoryLoaded=!1,this.http.post(r.a.apiUrl+"canteen/personal/top/history/",{user_id:this.currentUserID},this.httpNotGETOptions).subscribe(function(e){return a.b(t,void 0,void 0,function(){return a.e(this,function(t){return this.personalTopupHistory=e.reverse(),this.personalTopupHistory===[]&&(this.personalTopupHistory=[{topup:0,topup_date:"No Data Available"}]),this.topupHistoryLoaded=!0,[2]})})},function(e){switch(t.topupHistoryLoaded=!1,e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getUniquePaystackReference=function(){var t=this;return this.http.post(r.a.apiUrl+"canteen/random/generator/",{},this.httpNotGETOptions).subscribe(function(e){return a.b(t,void 0,void 0,function(){return a.e(this,function(t){return this.uniquePaystackReference=e[0].alphanumericserial,[2]})})},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.sendPaystackInfo=function(){var t=this;return this.http.post(r.a.apiUrl+"canteen/random/generator/",{},this.httpNotGETOptions).subscribe(function(e){return a.b(t,void 0,void 0,function(){return a.e(this,function(t){return this.uniquePaystackReference=e[0].alphanumericserial,[2]})})},function(e){switch(e.status){case 400:alert(h.a.e400);break;case 401:alert(h.a.e401),t.auth.refreshJWT();break;case 403:alert(h.a.e403);break;case 404:alert(h.a.e404);break;case 413:alert(h.a.e413);break;case 415:alert(h.a.e415);break;case 500:alert(h.a.e500);break;case 503:alert(h.a.e503)}})},t.prototype.getUserTransactions=function(t){return this.currentUserID=Number(this.cookieService.get("user_id")),this.http.post(r.a.apiUrl+"canteen/suc/staff/daytxn/",{user_id:this.currentUserID,check_date:t},this.httpNotGETOptions)},t.prototype.getUserTransactions1=function(t,e){return this.currentUserID=Number(this.cookieService.get("user_id")),this.http.post(r.a.apiUrl+"canteen/new_suc_range/",{user_id:this.currentUserID,check_date:t,end_date:e},this.httpNotGETOptions)},t.prototype.getUserTransactionItems=function(t){var e=this;return this.getUserTransactions(t).subscribe(function(t){return a.b(e,void 0,void 0,function(){var e;return a.e(this,function(s){for(this.grandTotal=0,this.todaysTransactions=t.reverse(),e=0;e<this.todaysTransactions.length;e++)this.grandTotal+=Number(this.todaysTransactions[e].total);return[2]})})},function(t){switch(t.status){case 401:e.auth.refreshJWT()}})},t.prototype.getUserPersonalTransactions=function(t){return this.currentUserID=Number(this.cookieService.get("user_id")),this.http.post(r.a.apiUrl+"canteen/day/staff/txn/",{user_id:this.currentUserID,check_date:t},this.httpNotGETOptions)},t.prototype.getUserPersonalTransactionItems=function(t){var e=this;return this.getUserTransactions(t).subscribe(function(t){return a.b(e,void 0,void 0,function(){var e;return a.e(this,function(s){for(this.grandTotal=0,this.todaysTransactions=t,e=0;e<this.todaysTransactions.length;e++)this.grandTotal+=Number(this.todaysTransactions[e].total);return[2]})})},function(t){switch(t.status){case 401:e.auth.refreshJWT()}})},t.prototype.getUserCardTransactions=function(t){return this.currentUserID=Number(this.cookieService.get("user_id")),this.http.post(r.a.apiUrl+"canteen/day/staff/txn/",{user_id:this.currentUserID,check_date:t},this.httpNotGETOptions)},t.prototype.getUserCardTransactionItems=function(t){var e=this;return this.getUserTransactions(t).subscribe(function(t){return a.b(e,void 0,void 0,function(){var e;return a.e(this,function(s){for(this.grandTotal=0,this.todaysTransactions=t,e=0;e<this.todaysTransactions.length;e++)this.grandTotal+=Number(this.todaysTransactions[e].total);return[2]})})},function(t){switch(t.status){case 401:e.auth.refreshJWT()}})},t.prototype.getVendTransactions=function(t){var e={user_id:JSON.parse(this.cookieService.get("user_id"))};return this.http.post(r.a.apiUrl+"canteen/teller/transactns/",e,this.httpNotGETOptions)},t.prototype.getVendGrandTotal=function(t){var e={check_date:t,ven_id:JSON.parse(this.cookieService.get("user_id"))};return this.http.post(r.a.apiUrl+"canteen/vendmonthly/",e,this.httpNotGETOptions)},t.prototype.getVendTransactionItems=function(t){var e=this;return this.getVendTransactions(t).subscribe(function(t){return a.b(e,void 0,void 0,function(){var e;return a.e(this,function(s){for(console.log(t),this.todaysTransactions=t.reverse(),e=0;e<t.length;e++)"Suc"===t[e].transaction_status&&(this.grandTotal+=Number(t[e].total));return[2]})})},function(t){switch(console.log(t),t.status){case 401:e.auth.refreshJWT()}})},t.prototype.getDaysTransactions=function(t){return this.http.post(r.a.apiUrl+"canteen/transact/eachday/",{check_date:t},this.httpNotGETOptions)},t.prototype.getDaysTransactions1=function(t,e){return this.http.post(r.a.apiUrl+"canteen/each_day_range/",{check_date:t,end_date:e},this.httpNotGETOptions)},t.prototype.getDaysTransactionItems=function(t){var e=this;this.todaysTransactions=[];var s=JSON.parse(this.cookieService.get("isComp")),a=this.cookieService.get("compName");return this.getDaysTransactions(t).subscribe(function(t){if(e.grandTotal=0,0===t.length)return 0;if(s){t.filter(function(t){t.company===a&&(e.todaysTransactions.push(t),e.grandTotal+=Number(t.total))}),e.todaysTransactionCount=0,e.todaysTransactionFoodNames=[],e.todaysTransactionFoodQuantities=[];for(var i=0;i<e.todaysTransactions.length;i++){e.todaysTransactionCount++,e.todaysTransactionsOrderList=e.todaysTransactions[i].order_list;for(var o=0;o<e.todaysTransactionsOrderList.length;o++)if(e.todaysTransactionFoodNames.push(e.todaysTransactionsOrderList[o].food_name),e.todaysTransactionFoodQuantities===[])e.todaysTransactionFoodQuantities.push(e.todaysTransactionsOrderList[o].quantity);else if(e.todaysTransactionFoodNames.indexOf(e.todaysTransactionsOrderList[o].food_name)>-1){if(null===e.todaysTransactionFoodQuantities[e.todaysTransactionFoodNames.indexOf(e.todaysTransactionsOrderList[o].food_name)])return;if(null===e.todaysTransactionFoodQuantities[e.todaysTransactionFoodNames.indexOf(e.todaysTransactionsOrderList[o].food_name)])return;e.todaysTransactionFoodQuantities[e.todaysTransactionFoodNames.indexOf(e.todaysTransactionsOrderList[o].food_name)].quantity+=e.todaysTransactionsOrderList[o].quantity}else{if(null===e.todaysTransactionsOrderList[o])return;e.todaysTransactionFoodQuantities.push(e.todaysTransactionsOrderList[o].quantity)}}}else for(e.todaysTransactions=t,e.todaysTransactionCount=0,e.grandTotal=0,e.todaysTransactionFoodNames=[],e.todaysTransactionFoodQuantities=[],i=0;i<e.todaysTransactions.length;i++)e.grandTotal+=Number(e.todaysTransactions[i].total)},function(t){switch(t.status){case 401:e.auth.refreshJWT()}})},t.prototype.getTotalCostData=function(t,e){return this.http.post(r.a.apiUrl+"canteen/daily/spentmonthly/staff/",{cmp_id:e,check_date:t},this.httpNotGETOptions)},t.prototype.getTotalCostItems=function(t,e){var s=this;this.totalCostListIsLoaded=!1,this.getTotalCostData(t,e).subscribe(function(t){s.totalCostItems=[],s.totalCostItems=t,s.totalCostItemsUpdate.next(s.totalCostItems.slice()),s.totalCostListIsLoaded=!0,console.log(s.totalCostItems)})},t.prototype.getTotalCostItemsUpdate=function(){return this.totalCostItemsUpdate.asObservable()},t.prototype.getTotalCostSum=function(t,e){return this.http.post(r.a.apiUrl+"canteen/total/spent/company/",{cmp_id:e,check_date:t},this.httpNotGETOptions)},t.prototype.getDaysRevenue=function(){var t=this;this.http.post(r.a.apiUrl+"canteen/all/transaction/",{},this.httpNotGETOptions).subscribe(function(e){return a.b(t,void 0,void 0,function(){return a.e(this,function(t){return this.grandTransactionTotal=0,(e=[])?[2,0]:(this.grandTransactionTotal+=Number(e[0].total_sales),[2,this.grandTransactionTotal])})})},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getDaysStartStock=function(t){var e=this;this.http.post(r.a.apiUrl+"canteen/added/stock/",{check_date:t},this.httpNotGETOptions).subscribe(function(t){return a.b(e,void 0,void 0,function(){var e;return a.e(this,function(s){for(this.todaysStartStockCount=0,e=0;e<t.length;e++)this.todaysStartStockCount+=t[e].total_quantity;return[2,this.todaysStartStockCount]})})},function(t){switch(t.status){case 401:e.auth.refreshJWT()}})},t.prototype.getDaysEndStock=function(t){},t.prototype.voidTransaction=function(t){var e=this,s=this.getTodaysDate();return this.currentUserID=Number(this.cookieService.get("user_id")),this.http.post(r.a.apiUrl+"canteen/addvoid/",{amount:0,created_date:s,transaction:t.transactionID,user_void:this.currentUserID},this.httpNotGETOptions).subscribe(function(s){return a.b(e,void 0,void 0,function(){return a.e(this,function(e){return alert("Transaction No."+t.transactionID+" Voided Successfully"),[2]})})},function(t){switch(t.status){case 400:alert(h.a.e400);break;case 401:alert(h.a.e401),e.auth.refreshJWT();break;case 403:alert(h.a.e403);break;case 404:alert(h.a.e404);break;case 413:alert(h.a.e413);break;case 415:alert(h.a.e415);break;case 500:alert(h.a.e500);break;case 503:alert(h.a.e503)}})},t.prototype.noRefundVoidTransaction=function(t){var e=this,s=this.getTodaysDate();return this.currentUserID=Number(this.cookieService.get("user_id")),this.http.post(r.a.apiUrl+"canteen/addnoref/",{amount:0,created_date:s,transaction:t.transactionID,user_void:this.currentUserID},this.httpNotGETOptions).subscribe(function(s){return a.b(e,void 0,void 0,function(){return a.e(this,function(e){return alert("Transaction No."+t.transactionID+" Voided Successfully"),[2]})})},function(t){switch(t.status){case 400:alert(h.a.e400);break;case 401:alert(h.a.e401),e.auth.refreshJWT();break;case 403:alert(h.a.e403);break;case 404:alert(h.a.e404);break;case 413:alert(h.a.e413);break;case 415:alert(h.a.e415);break;case 500:alert(h.a.e500);break;case 503:alert(h.a.e503)}})},t.prototype.displayTransaction=function(t){this.selectedTransaction=t},t.prototype.purchase=function(t,e,s){var a,i,o=this,n=(new Date,[]);a=JSON.stringify(n)===JSON.stringify(e)?null:e.map(function(t){return{combo:t.food,quantity:t.quantity,name:t.food_name,category:t.category,unit_price:t.unit_price,total:t.total,imageUrl:t.imageUrl,basket:t.combo}}),i=JSON.stringify(n)===JSON.stringify(t)?null:t;var c={user_id:Number(this.cookieService.get("user_id")),date:"",time_created:"",total:s,order_name:i,combo_name:a,option:"cd",status:"",company:3,teller:5,delivery_status:"",delivery_date:""+this.getTodaysDate()};return this.http.post(r.a.apiUrl+"canteen/transaction/",c,this.httpNotGETOptions).subscribe(function(t){o.http.post(r.a.apiUrl+"canteen/receipt/",{txn_id:t.id},o.httpNotGETOptions).subscribe(function(t){o.pService.getStaffDataItems(),"Suc"===t[0].transaction_status?(o.cookieService.delete("buccaBasket"),o.oService.basket=[],o.oService.orderBasket=[],o.cookieService.delete("basketTotal"),o.oService.basketTotal=0,o.oService.orderBasketTotal=0,alert("Transaction Successful")):"Uns"===t[0].transaction_status?alert("Transaction Unsuccessful"):"Ins"===t[0].transaction_status?alert("Insufficient Funds"):"Nos"===t[0].transaction_status&&alert("Not Enough Stock")},function(t){console.log(t)})},function(t){switch(console.log(t),t.status){case 400:alert(h.a.e400);break;case 401:alert(h.a.e401);break;case 403:alert(h.a.e403);break;case 404:alert(h.a.e404);break;case 415:alert(h.a.e415);break;case 500:alert(h.a.e500);break;case 503:alert(h.a.e503)}})},t.prototype.getDays=function(t){return this.http.post(r.a.apiUrl+"canteen/counttxn/",{check_date:t},this.httpNotGETOptions)},t.prototype.getVendDays=function(t){var e={check_date:t,ven_id:JSON.parse(this.cookieService.get("user_id"))};return this.http.post(r.a.apiUrl+"canteen/vend_count/",e,this.httpNotGETOptions)},t.prototype.getCount=function(){var t=this;return this.isLoaded=!1,JSON.parse(this.cookieService.get("isVend"))?this.getVendDays(this.getTodaysDate()).subscribe(function(e){t.total=e[0].total,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}}):this.getDays(this.getTodaysDate()).subscribe(function(e){t.apiItems=e,t.total=e[0].total,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getAccountTopupHistory=function(){var t=this;return this.http.get(r.a.apiUrl+"canteen/comp_history/ ",this.httpGETOptions).subscribe(function(e){console.log(e),e.length>0&&(t.accountTopUpHistory=e.reverse(),t.accountTopUpHistoryIsLoaded=!0,t.inflowSum=e.map(function(t){return t.amount_added}).reduce(function(t,e){return t+e}),console.log(t.inflowSum))},function(t){switch(t.status){case 400:alert(h.a.e400);break;case 401:alert(h.a.e401);break;case 403:alert(h.a.e403);break;case 404:alert(h.a.e404);break;case 415:alert(h.a.e415);break;case 500:alert(h.a.e500);break;case 503:alert(h.a.e503)}})},t.prototype.allVendorCashOutHistory=function(){var t=this;return this.http.get(r.a.apiUrl+"canteen/vendor_withdrawal_history/ ",this.httpGETOptions).subscribe(function(e){console.log(e),t.vendorCashBackList=e.reverse(),t.vendorCashBackListUpdate.next(t.vendorCashBackList.slice())})},t.prototype.getVendorCashOutHistoryUpdate=function(){return this.vendorCashBackListUpdate.asObservable()},t.prototype.cashBackHistory=function(){var t=this;return this.http.get(r.a.apiUrl+"canteen/withdraw_history/ ",this.httpGETOptions).subscribe(function(e){console.log(e);var s=t.cookieService.get("company"),a=t.cookieService.get("user_id");t.cashBackList=e.reverse(),t.companycashBackList=e.filter(function(t){return t.vendor===Number(s)}),t.companycashBackListUpdate.next(t.companycashBackList.slice()),t.userCashBack=e.filter(function(t){return t.vendor===Number(a)}),t.userCashBackUpdate.next(t.userCashBack.slice()),console.log(a)})},t.prototype.getCompanyCashoutUpdate=function(){return this.companycashBackListUpdate.asObservable()},t.prototype.getCashoutUpdate=function(){return this.userCashBackUpdate.asObservable()},t.ngInjectableDef=d.cc({factory:function(){return new t(d.dc(i.c),d.dc(u.a),d.dc(o.a),d.dc(c.a),d.dc(n.a),d.dc(l.l))},token:t,providedIn:"root"}),t}()}}]);