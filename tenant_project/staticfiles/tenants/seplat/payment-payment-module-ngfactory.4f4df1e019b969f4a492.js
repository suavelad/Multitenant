(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"9DpL":function(n,l,t){"use strict";t.r(l);var e=t("CcnG"),u=function(){return function(){}}(),o=t("pMnS"),s=t("gIcY"),a=t("Ip0R"),i=t("APIH"),r=t("xOo0"),c=t("v0/F"),p=t("yHeE"),b=t("kmKP"),h=t("9GzQ"),d=(t("j7t6"),t("aR35")),f=function(){function n(n,l,t,e,u){this.pService=n,this.appRef=l,this.uService=t,this.tService=e,this.tuService=u,this.paystackKey=d.a.paystack,this.showPaystack=!1}return n.prototype.ngOnInit=function(){this.tService.getUniquePaystackReference(),this.pService.getItems()},n.prototype.setValueForMaster=function(){},n.prototype.checkProcessCharge=function(n){this.paystackAmount2=100*Number(n.value.amount),this.processCharge=.015*this.paystackAmount2,this.processCharge>2e5?(this.paystackAmount2+=2e5,console.log(this.paystackAmount2)):(this.paystackAmount2+=.015*this.paystackAmount2,console.log(this.paystackAmount2))},n.prototype.setValuesForPaystack=function(n){var l=this,t={total:Number(n.value.amount),staff_no:1,user_id:Number(this.pService.currentProfileID),type:"per"};console.log(t),this.tuService.getMasterRefId(t).subscribe(function(t){var e=[];console.log(t),e.push({status:1,ref_no:t.ref_no,amount_added:t.total,user_id:t.user_id,firstname:"",lastname:"",company:"",email:""}),console.log(e),l.tuService.postDetailsTable(e).subscribe(function(e){console.log(e),l.tuService.changeToValid(t.ref_no).subscribe(function(t){console.log(t),l.paystackAmount=100*Number(n.value.amount),l.showPaystack=!0,n.reset()})}),l.tRef=t.ref_no})},n.prototype.sayHello=function(){console.log("Payment Done")},n.prototype.paymentCancel=function(){console.log("No payment times.")},n.prototype.paymentDone=function(n){console.log("Payment Done"),console.log(n),this.tuService.changeToValid(this.tRef).subscribe(function(n){alert("Congratulations!!! Payment was Successful ")}),console.log(this.tRef),this.showPaystack=!1},n}(),g=e.Ab({encapsulation:0,styles:[["div.test-mode-badge{display:none!important}"]],data:{}});function m(n){return e.Yb(0,[(n()(),e.Cb(0,0,null,null,1,"p",[["class","prjct-input-danger-help-text"]],null,null,null,null,null)),(n()(),e.Wb(-1,null,["Please enter a valid number"]))],null,null)}function y(n){return e.Yb(0,[(n()(),e.Cb(0,0,null,null,32,null,null,null,null,null,null,null)),(n()(),e.Cb(1,0,null,null,31,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],function(n,l,t){var u=!0,o=n.component;return"submit"===l&&(u=!1!==e.Ob(n,3).onSubmit(t)&&u),"reset"===l&&(u=!1!==e.Ob(n,3).onReset()&&u),"ngSubmit"===l&&(o.setValuesForPaystack(e.Ob(n,3)),u=!1!==o.checkProcessCharge(e.Ob(n,3))&&u),u},null,null)),e.Bb(2,16384,null,0,s.C,[],null,null),e.Bb(3,4210688,[["prePaystackForm",4]],0,s.q,[[8,null],[8,null]],null,{ngSubmit:"ngSubmit"}),e.Tb(2048,null,s.d,null,[s.q]),e.Bb(5,16384,null,0,s.p,[[4,s.d]],null,null),(n()(),e.Cb(6,0,null,null,6,"div",[["class","row"]],null,null,null,null,null)),(n()(),e.Cb(7,0,null,null,5,"div",[["class","col-xs-12 col-md-12"]],null,null,null,null,null)),(n()(),e.Cb(8,0,null,null,4,"p",[],null,null,null,null,null)),e.Tb(512,null,a.z,a.A,[e.x,e.y,e.n,e.M]),e.Bb(10,278528,null,0,a.k,[a.z],{ngClass:[0,"ngClass"]},null),e.Rb(11,{"prjct-input-danger-help-text":0}),(n()(),e.Wb(-1,null,["Enter Amount*"])),(n()(),e.Cb(13,0,null,null,13,"div",[["class","row"]],null,null,null,null,null)),(n()(),e.Cb(14,0,null,null,12,"div",[["class","input-group mb-3 col-xs-12 col-md-12"]],null,null,null,null,null)),(n()(),e.Cb(15,0,null,null,11,"input",[["class","form-control prjct-soft-corners"],["min","1"],["name","amount"],["ngModel",""],["placeholder","Amount*"],["required",""],["type","number"]],[[1,"required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(n,l,t){var u=!0;return"input"===l&&(u=!1!==e.Ob(n,19)._handleInput(t.target.value)&&u),"blur"===l&&(u=!1!==e.Ob(n,19).onTouched()&&u),"compositionstart"===l&&(u=!1!==e.Ob(n,19)._compositionStart()&&u),"compositionend"===l&&(u=!1!==e.Ob(n,19)._compositionEnd(t.target.value)&&u),"change"===l&&(u=!1!==e.Ob(n,20).onChange(t.target.value)&&u),"input"===l&&(u=!1!==e.Ob(n,20).onChange(t.target.value)&&u),"blur"===l&&(u=!1!==e.Ob(n,20).onTouched()&&u),u},null,null)),e.Tb(512,null,a.z,a.A,[e.x,e.y,e.n,e.M]),e.Bb(17,278528,null,0,a.k,[a.z],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Rb(18,{"prjct-input-danger":0}),e.Bb(19,16384,null,0,s.e,[e.M,e.n,[2,s.a]],null,null),e.Bb(20,16384,null,0,s.t,[e.M,e.n],null,null),e.Bb(21,16384,null,0,s.w,[],{required:[0,"required"]},null),e.Tb(1024,null,s.l,function(n){return[n]},[s.w]),e.Tb(1024,null,s.m,function(n,l){return[n,l]},[s.e,s.t]),e.Bb(24,671744,[["amountInput",4]],0,s.r,[[2,s.d],[6,s.l],[8,null],[6,s.m]],{name:[0,"name"],model:[1,"model"]},null),e.Tb(2048,null,s.n,null,[s.r]),e.Bb(26,16384,null,0,s.o,[[4,s.n]],null,null),(n()(),e.Cb(27,0,null,null,3,"div",[["class","row"]],null,null,null,null,null)),(n()(),e.Cb(28,0,null,null,2,"div",[["class","col-xs-12 col-md-12"]],null,null,null,null,null)),(n()(),e.rb(16777216,null,null,1,null,m)),e.Bb(30,16384,null,0,a.m,[e.X,e.U],{ngIf:[0,"ngIf"]},null),(n()(),e.Cb(31,0,null,null,1,"button",[["class","btn prjct-btn prjct-soft-corners"],["type","submit"]],[[8,"disabled",0]],null,null,null,null)),(n()(),e.Wb(-1,null,["Proceed"]))],function(n,l){var t=n(l,11,0,e.Ob(l,24).invalid&&e.Ob(l,24).touched);n(l,10,0,t);var u=n(l,18,0,e.Ob(l,24).invalid&&e.Ob(l,24).touched);n(l,17,0,"form-control prjct-soft-corners",u),n(l,21,0,""),n(l,24,0,"amount",""),n(l,30,0,e.Ob(l,24).invalid&&e.Ob(l,24).touched)},function(n,l){n(l,1,0,e.Ob(l,5).ngClassUntouched,e.Ob(l,5).ngClassTouched,e.Ob(l,5).ngClassPristine,e.Ob(l,5).ngClassDirty,e.Ob(l,5).ngClassValid,e.Ob(l,5).ngClassInvalid,e.Ob(l,5).ngClassPending),n(l,15,0,e.Ob(l,21).required?"":null,e.Ob(l,26).ngClassUntouched,e.Ob(l,26).ngClassTouched,e.Ob(l,26).ngClassPristine,e.Ob(l,26).ngClassDirty,e.Ob(l,26).ngClassValid,e.Ob(l,26).ngClassInvalid,e.Ob(l,26).ngClassPending),n(l,31,0,e.Ob(l,3).invalid)})}function v(n){return e.Yb(0,[(n()(),e.Cb(0,0,null,null,6,null,null,null,null,null,null,null)),(n()(),e.Cb(1,0,null,null,5,"div",[["class","container"]],null,null,null,null,null)),(n()(),e.Cb(2,0,null,null,4,"div",[["class","row"]],null,null,null,null,null)),(n()(),e.Cb(3,0,null,null,3,"div",[["class","col-xs-12 col-sm-12 col-md-12"]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.sayHello()&&e),e},null,null)),(n()(),e.Cb(4,0,null,null,2,"angular4-paystack-embed",[],[[8,"className",0],[8,"style",2]],[[null,"callback"],[null,"close"]],function(n,l,t){var e=!0,u=n.component;return"callback"===l&&(e=!1!==u.paymentDone(t)&&e),"close"===l&&(e=!1!==u.paymentCancel()&&e),e},i.b,i.a)),e.Bb(5,114688,null,0,r.b,[],{key:[0,"key"],email:[1,"email"],amount:[2,"amount"],ref:[3,"ref"]},{close:"close",callback:"callback"}),e.Rb(6,{height:0})],function(n,l){var t=l.component;n(l,5,0,t.paystackKey,t.pService.apiData.email,t.paystackAmount2,t.tRef)},function(n,l){var t=n(l,6,0,"20rem !important");n(l,4,0,"embeded-paystack btn btn-block",t)})}function C(n){return e.Yb(0,[(n()(),e.Cb(0,0,null,null,13,"div",[["class","align-items-center animated fadeIn"]],null,null,null,null,null)),(n()(),e.Cb(1,0,null,null,12,"div",[["class","container create-admin-container"]],null,null,null,null,null)),(n()(),e.Cb(2,0,null,null,11,"div",[["class","row"]],null,null,null,null,null)),(n()(),e.Cb(3,0,null,null,10,"div",[["class","col-md-8 default-container"]],null,null,null,null,null)),(n()(),e.Cb(4,0,null,null,9,"div",[["class","card prjct-soft-corners"]],null,null,null,null,null)),(n()(),e.Cb(5,0,null,null,8,"div",[["class","card-body p-4"]],null,null,null,null,null)),(n()(),e.Cb(6,0,null,null,1,"h1",[],null,null,null,null,null)),(n()(),e.Wb(-1,null,["Top Up"])),(n()(),e.Cb(8,0,null,null,1,"p",[["class","text-muted"]],null,null,null,null,null)),(n()(),e.Wb(-1,null,["Top Up Meal Card"])),(n()(),e.rb(16777216,null,null,1,null,y)),e.Bb(11,16384,null,0,a.m,[e.X,e.U],{ngIf:[0,"ngIf"]},null),(n()(),e.rb(16777216,null,null,1,null,v)),e.Bb(13,16384,null,0,a.m,[e.X,e.U],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,11,0,!t.showPaystack),n(l,13,0,t.showPaystack)},null)}function k(n){return e.Yb(0,[(n()(),e.Cb(0,0,null,null,1,"app-payment",[],null,null,null,C,g)),e.Bb(1,114688,null,0,f,[c.a,e.g,b.a,p.a,h.a],null,null)],function(n,l){n(l,1,0)},null)}var O=e.yb("app-payment",f,k,{},{},[]),T=t("t/Na"),U=t("uFtX"),S=t("SbLv"),I=t("NuUg"),A=t("ZYCi"),M={title:"Payment"},P=function(){return function(){}}();t.d(l,"PaymentModuleNgFactory",function(){return w});var w=e.zb(u,[],function(n){return e.Lb([e.Mb(512,e.l,e.kb,[[8,[o.a,O]],[3,e.l],e.D]),e.Mb(4608,a.o,a.n,[e.z,[2,a.E]]),e.Mb(4608,s.A,s.A,[]),e.Mb(4608,c.a,c.a,[T.c,U.a,S.a]),e.Mb(4608,p.a,p.a,[T.c,U.a,S.a,c.a,I.a,A.l]),e.Mb(1073742336,a.c,a.c,[]),e.Mb(1073742336,s.z,s.z,[]),e.Mb(1073742336,s.i,s.i,[]),e.Mb(1073742336,A.p,A.p,[[2,A.u],[2,A.l]]),e.Mb(1073742336,P,P,[]),e.Mb(1073742336,r.c,r.c,[]),e.Mb(1073742336,u,u,[]),e.Mb(1024,A.j,function(){return[[{path:"payment",component:f,data:M}]]},[])])})},"9GzQ":function(n,l,t){"use strict";t.d(l,"a",function(){return r});var e=t("aR35"),u=t("t/Na"),o=t("uFtX"),s=t("SbLv"),a=t("K9Ia"),i=t("CcnG"),r=function(){function n(n,l,t){this.http=n,this.auth=l,this.cookieService=t,this.appUrl=e.a.apiUrl,this.serviceUrl="canteen/topuphistory/",this.apiUrl=e.a.apiUrl+this.serviceUrl,this.isLoaded=!1,this.today="",this.apiItems=[],this.apsItems=[],this.isUploading=!1,this.balance=0,this.autoListListener=new a.a,this.httpGETOptions={headers:new u.h({"Content-Type":"application/json",Accept:"application/json","X-CSRFToken":this.cookieService.get("csrftoken"),Authorization:"Bearer "+this.cookieService.get("buccaTokenAccess")})},this.httpNotGETOptions={headers:new u.h({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.cookieService.get("buccaTokenAccess")})}}return n.prototype.getMasterData=function(n){var l=n.map(function(n){return n.amount_added}),t={total:null,staff_no:null,user_id:null,type:""};return t.total=l.reduce(function(n,l){return n+l},0),t.staff_no=n.length,t.user_id=JSON.parse(this.cookieService.get("user_id")),t},n.prototype.resetStaff=function(){return this.http.post(e.a.apiUrl+"canteen/reset/",{},this.httpNotGETOptions)},n.prototype.getTopUpList=function(){return this.http.get(e.a.apiUrl+"canteen/tp/",this.httpGETOptions)},n.prototype.getTopupListItems=function(){var n=this;return this.getTopUpList().subscribe(function(l){n.apsItems=l,n.isLoaded=!0},function(l){switch(l.status){case 401:n.auth.refreshJWT()}})},n.prototype.getData=function(n){return this.http.post(this.apiUrl,{check_date:n},this.httpNotGETOptions)},n.prototype.getItems=function(){var n=this;return this.isLoaded=!1,this.getData(this.getTodaysDate()).subscribe(function(l){n.apiItems=l,n.isLoaded=!0},function(l){switch(l.status){case 401:n.auth.refreshJWT()}})},n.prototype.getTodaysDate=function(){var n,l,t=new Date;n=Number((t.getDate()+1+"").substring(1,2))>0?t.getDate():"0"+t.getDate(),l=Number(t.getMonth()+1)>9?t.getMonth()+1:"0"+(t.getMonth()+1);var e=t.getFullYear();return this.today=e+"-"+l+"-"+n,this.today},n.prototype.getDateFromString=function(n){return n.split("T")[0]},n.prototype.getTimeFromString=function(n){return n.split(".")[0]},n.prototype.getMasterRefId=function(n){return this.http.post(this.appUrl+"canteen/master/",n,this.httpNotGETOptions)},n.prototype.postDetailsTable=function(n){return this.http.post(this.appUrl+"canteen/bulktopup/",n,this.httpNotGETOptions)},n.prototype.getDetailsTable=function(n){return this.http.get(this.appUrl+"canteen/bulktopup/"+n,this.httpGETOptions)},n.prototype.changeToValid=function(n){return this.http.post(this.appUrl+"canteen/valid/",{ref_no:n},this.httpNotGETOptions)},n.prototype.confirmPayment=function(n,l){var t={cmp_id:Number(l),ref_no:n};return console.log(t),this.http.post(this.appUrl+"canteen/confirm_payment/",t,this.httpNotGETOptions)},n.prototype.getAutoTopupList=function(){var n=this;this.http.get(this.appUrl+"canteen/recent_staffconfig/",this.httpGETOptions).subscribe(function(l){console.log(l),n.autoList=l,n.autoListListener.next(n.autoList.slice())},function(n){console.log(n)})},n.prototype.getAutoListListener=function(){return this.autoListListener.asObservable()},n.prototype.autoTopUpAccount=function(n){return this.http.post(this.appUrl+"canteen/autolist/",n,this.httpNotGETOptions)},n.prototype.getAccountBalance=function(){var n=this;this.http.post(this.appUrl+"canteen/compbal/",{cmp_id:3},this.httpNotGETOptions).subscribe(function(l){n.balance=l[0].total_balance})},n.prototype.topUpMockStaff=function(n){var l=this;this.http.post(this.appUrl+"canteen/master/",n,{reportProgress:!0,observe:"events"}).subscribe(function(n){n.type==u.f.UploadProgress||n.type===u.f.Response&&(l.progress=n)})},n.prototype.getStaffTopUpHistory=function(){return this.http.get(this.appUrl+"canteen/master/")},n.ngInjectableDef=i.cc({factory:function(){return new n(i.dc(u.c),i.dc(o.a),i.dc(s.a))},token:n,providedIn:"root"}),n}()},APIH:function(n,l,t){"use strict";t.d(l,"a",function(){return u}),t.d(l,"b",function(){return o});var e=t("CcnG");t("xOo0"),t("Ip0R");var u=e.Ab({encapsulation:2,styles:[],data:{}});function o(n){return e.Yb(2,[(n()(),e.Cb(0,0,null,null,0,"div",[["id","paystackEmbedContainer"]],null,null,null,null,null))],null,null)}},j7t6:function(n,l){}}]);