(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{Rt3T:function(t,e,o){"use strict";o.d(e,"a",function(){return r});var s=o("t/Na"),i=(o("SbLv"),o("aR35")),a=(o("tVYj"),o("uFtX"),o("mRTT")),r=function(){function t(t,e,o,a){this.http=t,this.auth=e,this.fService=o,this.cookieService=a,this.serviceUrl="canteen/daily/inventory/",this.apiUrl=i.a.apiUrl+this.serviceUrl,this.apiItems=[],this.isLoaded=!1,this.today="",this.httpGETOptions={headers:new s.h({"Content-Type":"application/json",Accept:"application/json","X-CSRFToken":this.cookieService.get("csrftoken"),Authorization:"Bearer "+this.cookieService.get("buccaTokenAccess")})},this.httpNotGETOptions={headers:new s.h({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.cookieService.get("buccaTokenAccess")})}}return t.prototype.create=function(t,e){var o=this;this.isUploading=!0;var s={quantity:t.quantity,food:e,user:Number(this.cookieService.get("user_id")),company_name:t.company_name};return this.http.post(i.a.apiUrl+"canteen/inventory/",s,this.httpNotGETOptions).subscribe(function(t){alert(s.quantity+" unit(s) added"),o.isUploading=!1,o.fService.getTodaysStock(o.fService.getTodaysDate())},function(t){switch(t.status){case 400:alert(a.a.e400);break;case 401:alert(a.a.e401),o.auth.refreshJWT();break;case 403:alert(a.a.e403);break;case 404:alert(a.a.e404);break;case 413:alert(a.a.e413);break;case 415:alert(a.a.e415);break;case 500:alert(a.a.e500);break;case 503:alert(a.a.e503)}})},t.prototype.getRollover=function(){var t=this;return this.http.post(i.a.apiUrl+"canteen/rollover/",{},this.httpNotGETOptions).subscribe(function(t){},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getData=function(t){return this.http.post(this.apiUrl,{check_date:t},this.httpNotGETOptions)},t.prototype.getItems=function(){var t=this;if(this.isLoaded=!1,!JSON.parse(this.cookieService.get("isVend")))return this.getData(this.getTodaysDate()).subscribe(function(e){t.apiItems=e,t.todaysInvFoodNames=[],t.todaysInvFoodQuantities=[];for(var o=0;o<t.apiItems.length;o++)t.todaysInvFoodNames.push(t.apiItems[o].food),t.todaysInvFoodQuantities.push(t.apiItems[o].total_quantity);t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}});this.getVendData(this.getTodaysDate()).subscribe(function(e){t.apiItems=e,t.todaysInvFoodNames=[],t.todaysInvFoodQuantities=[];for(var o=0;o<t.apiItems.length;o++)t.todaysInvFoodNames.push(t.apiItems[o].food),t.todaysInvFoodQuantities.push(t.apiItems[o].total_quantity);t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getTodaysDate=function(){var t,e,o=new Date;t=Number((o.getDate()+1+"").substring(1,2))>0?o.getDate():"0"+o.getDate(),e=Number(o.getMonth()+1)>9?o.getMonth()+1:"0"+(o.getMonth()+1);var s=o.getFullYear();return this.today=s+"-"+e+"-"+t,this.today},t.prototype.getStockData=function(){return this.http.get(i.a.apiUrl+"canteen/stock/",this.httpGETOptions)},t.prototype.getStockItems=function(){var t=this;return this.isLoaded=!1,this.getStockData().subscribe(function(e){t.stockItems=e,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getDateFromString=function(t){return t.split("T")[0]},t.prototype.getTimeFromString=function(t){return t.split(".")[0]},t.prototype.getUserList=function(){return this.http.get(i.a.apiUrl+"canteen/users/",this.httpGETOptions)},t.prototype.getUserListItems=function(){var t=this;return this.getUserList().subscribe(function(e){t.userListItems=e,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getFoodNameFromList=function(t){try{return this.foodListItems.find(function(e){return e.id===t}).name}catch(e){}},t.prototype.getFoodList=function(){return this.http.get(i.a.apiUrl+"canteen/food/",this.httpGETOptions)},t.prototype.getVendData=function(t){var e={check_date:t,ven_id:JSON.parse(this.cookieService.get("user_id"))};return this.http.post(i.a.apiUrl+"canteen/invvendor/",e,this.httpGETOptions)},t.prototype.getVendFoodList=function(){var t={ven_id:JSON.parse(this.cookieService.get("user_id"))};return this.http.post(i.a.apiUrl+"canteen/findvend/category/",t,this.httpGETOptions)},t.prototype.getFoodListItems=function(){var t=this;if(!JSON.parse(this.cookieService.get("isVend")))return this.getFoodList().subscribe(function(e){t.foodListItems=e,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}});this.getVendFoodList().subscribe(function(e){console.log(e),t.foodListItems=e,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getCompanyNameFromList=function(t){try{return this.companyListItems.find(function(e){return e.id===t}).name}catch(e){}},t.prototype.getCompanyList=function(){return this.http.get(i.a.apiUrl+"canteen/company/",this.httpGETOptions)},t.prototype.getCompanyListItems=function(){var t=this;return this.getCompanyList().subscribe(function(e){t.companyListItems=e,t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t}()},tVYj:function(t,e,o){"use strict";o.d(e,"a",function(){return l});var s=o("mrSG"),i=o("t/Na"),a=o("SbLv"),r=o("aR35"),n=o("uFtX"),c=o("mRTT"),h=o("v0/F"),u=o("K9Ia"),d=o("CcnG"),p=o("ZYCi"),l=function(){function t(t,e,o,s,a){this.http=t,this.auth=e,this.pService=o,this.cookieService=s,this.router=a,this.apiUrl=r.a.apiUrl,this.listApiUrl="canteen/food/",this.comboApiUrl="canteen/combo/",this.listUrl=r.a.apiUrl+this.listApiUrl,this.comboUrl=r.a.apiUrl+this.comboApiUrl,this.listItemsUpdate=new u.a,this.todaysStockFoodNames=[],this.todaysStockFoodQuantities=[],this.foodCount=0,this.foodComboCount=0,this.currentMeetingCode=this.cookieService.get("user_id"),this.currentUsername=this.cookieService.get("username"),this.foodDetailApiUrl="canteen/food/",this.foodDetailUrl=r.a.apiUrl+this.foodDetailApiUrl+this.currentMeetingCode+"/",this.isLoaded=!1,this.isUploading=!1,this.listFoodByCategoryTerm="",this.cat_id=null,this.showListOrCategoriesTerm="category",this.showCategoryList=!0,this.showCategoryListContents=!0,this.showFoodList=!1,this.showFoodListContents=!0,this.showComboList=!1,this.showComboListContents=!0,this.showAddCombo=!1,this.showEditCombo=!1,this.showAddCategory=!1,this.showAddFood=!1,this.showEditCategory=!1,this.showEditFood=!1,this.showAddStock=!1,this.today="",this.httpGETOptions={headers:new i.h({"Content-Type":"application/json",Accept:"application/json","X-CSRFToken":this.cookieService.get("csrftoken"),Authorization:"Bearer "+this.cookieService.get("buccaTokenAccess")})},this.httpNotGETOptions={headers:new i.h({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.cookieService.get("buccaTokenAccess")})}}return t.prototype.create=function(t,e){var o=this;this.isUploading=!0;var s={image:e.split(",")[1],name:t.name,unit_price:t.unit_price,unit_measure:t.unit_measure,category:Number(t.category),company:Number(this.cookieService.get("company")),user:Number(this.cookieService.get("user_id"))};return this.http.post(r.a.apiUrl+"canteen/food/",s,this.httpNotGETOptions).subscribe(function(t){o.isUploading=!1,alert("Food Item: "+s.name+" created successfully."),o.getFoodListItems(),o.viewFoodListContents()},function(t){switch(window.location.reload(),o.isUploading=!1,t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),o.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}})},t.prototype.editFood=function(t,e,o,s){var i=this;console.log(s),this.isUploading=!0;var a={name:t,unit_measure:e,unit_price:o,image:s,user:Number(this.cookieService.get("user_id"))};return this.http.patch(r.a.apiUrl+"canteen/food/"+this.foodItemToBeEdited.id+"/",a,this.httpNotGETOptions).subscribe(function(e){i.isUploading=!1,alert("Food Item: "+t+" edited successfully."),i.getFoodListItems(),i.viewFoodListContents()},function(t){switch(console.log(t),i.isUploading=!1,t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),i.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}})},t.prototype.deleteFoodItem=function(t){var e=this;return this.isUploading=!0,this.http.delete(r.a.apiUrl+"canteen/food/"+t.id+"/",this.httpNotGETOptions).subscribe(function(o){e.isUploading=!1,alert("Food Item: "+t.name+" deleted successfully."),e.getFoodListItems()},function(t){switch(e.isUploading=!1,t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),e.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}})},t.prototype.createCategory=function(t){var e=this;this.isUploading=!0;var o={name:t.name,item:Number(t.isPerishable),user:Number(this.cookieService.get("user_id"))};return console.log(o),this.http.post(r.a.apiUrl+"canteen/category/",o,this.httpNotGETOptions).subscribe(function(t){console.log(t),e.isUploading=!1,alert("Category Item: "+o.name+" created successfully."),e.getFoodCategoryItems(),e.viewCategoryListContents()},function(t){switch(console.log(t),t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),e.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}e.isUploading=!1})},t.prototype.editCategory=function(t){var e=this;return this.isUploading=!0,this.http.patch(r.a.apiUrl+"canteen/category/"+this.categoryToBeEdited.id+"/",{name:t},this.httpNotGETOptions).subscribe(function(o){e.isUploading=!1,alert("Category Item: "+t+" edited successfully."),e.getFoodCategoryItems(),e.viewCategoryListContents()},function(t){switch(e.isUploading=!1,t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),e.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}})},t.prototype.deleteCategoryItem=function(t){var e=this;return this.isUploading=!0,this.http.delete(r.a.apiUrl+"canteen/category/"+t.id+"/",this.httpNotGETOptions).subscribe(function(o){e.isUploading=!1,alert("Food Item: "+t.name+" deleted successfully."),e.getFoodCategoryItems()},function(t){switch(e.isUploading=!1,t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),e.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}})},t.prototype.viewCategoryList=function(){this.showFoodList=!1,this.showCategoryList=!0},t.prototype.viewCategoryListContents=function(){this.showCategoryListContents=!0,this.showAddCategory=!1,this.showEditCategory=!1},t.prototype.viewAddCategory=function(){this.showCategoryListContents=!1,this.showAddCategory=!0,this.showEditCategory=!1},t.prototype.viewEditCategory=function(t){this.showCategoryListContents=!1,this.showAddCategory=!1,this.showEditCategory=!0,this.categoryToBeEdited=t},t.prototype.viewFoodListContents=function(){this.showFoodListContents=!0,this.showAddFood=!1,this.showEditFood=!1,this.showAddStock=!1},t.prototype.viewAddFood=function(){this.showFoodListContents=!1,this.showAddFood=!0,this.showEditFood=!1,this.showAddStock=!1},t.prototype.viewEditFood=function(t){this.showFoodListContents=!1,this.showAddFood=!1,this.showEditFood=!0,this.showAddStock=!1,this.foodItemToBeEdited=t},t.prototype.viewAddStock=function(t){this.showFoodListContents=!1,this.showAddFood=!1,this.showEditFood=!1,this.showAddStock=!0,this.foodItemToBeEdited=t},t.prototype.resetCounters=function(){this.foodCount=0},t.prototype.getItems=function(){this.getFoodCategoryItems(),this.getFoodListItems(),this.getTodaysDate(),this.getTodaysStock(this.getTodaysDate()),this.getTodaysStockII(this.getTodaysDate())},t.prototype.getFoodItemStockCount=function(t,e){return this.stockListItemsII.find(function(o){return o.food===t&&o.food_name===e})?Number(this.stockListItemsII.find(function(o){return o.food===t&&o.food_name===e}).total_quantity):0},t.prototype.getTodaysStock=function(t){var e=this,o={check_date:t,ven_id:JSON.parse(this.cookieService.get("user_id"))};return JSON.parse(this.cookieService.get("isVend"))?this.http.post(r.a.apiUrl+"canteen/daily_vend_stock/",o,this.httpNotGETOptions).subscribe(function(t){return s.b(e,void 0,void 0,function(){var e;return s.e(this,function(o){for(this.stockListItems=t,this.todaysStockFoodNames=[],this.todaysStockFoodQuantities=[],e=0;e<this.stockListItems.length;e++)this.todaysStockFoodNames.push(this.stockListItems[e].food),this.todaysStockFoodQuantities.push(this.stockListItems[e].total_quantity);return[2]})})},function(t){switch(t.status){case 401:e.auth.refreshJWT()}}):this.http.post(r.a.apiUrl+"canteen/added/stock/",{check_date:t},this.httpNotGETOptions).subscribe(function(t){return s.b(e,void 0,void 0,function(){var e;return s.e(this,function(o){for(this.stockListItems=t,this.todaysStockFoodNames=[],this.todaysStockFoodQuantities=[],e=0;e<this.stockListItems.length;e++)this.todaysStockFoodNames.push(this.stockListItems[e].food),this.todaysStockFoodQuantities.push(this.stockListItems[e].total_quantity);return[2]})})},function(t){switch(t.status){case 401:e.auth.refreshJWT()}})},t.prototype.getTodaysStockII=function(t){var e=this;return this.http.post(r.a.apiUrl+"canteen/all/stock/",{check_date:t},this.httpNotGETOptions).subscribe(function(t){return s.b(e,void 0,void 0,function(){return s.e(this,function(e){return this.stockListItemsII=t,[2]})})},function(t){switch(t.status){case 401:e.auth.refreshJWT()}})},t.prototype.getDateFromString=function(t){return t.split("T")[0]},t.prototype.getTimeFromString=function(t){return t.split(".")[0]},t.prototype.getFoodCategories=function(){if(4===Number(this.cookieService.get("user_g"))){var t=Number(this.cookieService.get("user_id"));return this.http.post(r.a.apiUrl+"canteen/vend/category/",{user:t},this.httpGETOptions)}return this.http.get(r.a.apiUrl+"canteen/category/",this.httpGETOptions)},t.prototype.getFoodCategoryItems=function(){var t=this;return this.getFoodCategories().subscribe(function(e){t.categories=e,t.isLoaded=!0,t.categoryCount=0;for(var o=0;o<t.categories.length;o++)t.categoryCount++},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getFoodList=function(){return this.http.get(this.listUrl,this.httpNotGETOptions)},t.prototype.getVendFoodList=function(){var t={ven_id:JSON.parse(this.cookieService.get("user_id"))};return this.http.post(this.apiUrl+"canteen/findvend/category/",t,this.httpNotGETOptions)},t.prototype.getFoodListItems=function(){var t=this;return JSON.parse(this.cookieService.get("isVend"))?this.getVendFoodList().subscribe(function(e){t.listItems=e.map(function(t){return{category:t.category_id,id:t.id,image:t.image,name:t.name,unit_price:t.unit_price}}),t.listItemsUpdate.next(t.listItems.slice()),t.foodCount=0;for(var o=0;o<t.listItems.length;o++)t.foodCount++;t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}}):this.getFoodList().subscribe(function(e){t.listItems=e,t.listItemsUpdate.next(t.listItems.slice()),t.foodCount=0;for(var o=0;o<t.listItems.length;o++)t.foodCount++;t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getFoodListUpdate=function(){return this.listItemsUpdate.asObservable()},t.prototype.countFoodItems=function(){this.foodCount=0;for(var t=0;t<this.listItems.length;t++)this.foodCount++;return this.foodCount},t.prototype.refreshApiUrl=function(){this.currentMeetingCode=null,this.currentUsername=null,this.currentMeetingCode=this.cookieService.get("user_id"),this.currentUsername=this.cookieService.get("username"),this.foodDetailUrl=r.a.apiUrl+this.foodDetailApiUrl+this.currentMeetingCode+"/"},t.prototype.getFood=function(){return this.http.get(this.foodDetailUrl)},t.prototype.getFoodDetails=function(){var t=this;return this.getFood().subscribe(function(e){return s.b(t,void 0,void 0,function(){return s.e(this,function(t){return this.foodDetails=e,this.meetingCode=this.foodDetails.meetingCode,this.time=this.foodDetails.time,this.subject=this.foodDetails.subject,this.duration=this.foodDetails.duration,this.date=e.date,this.type=e.type,this.meetingRoom=e.meetingRoom,this.creatorStaffID=e.creatorStaffID,[2]})})},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.getTodaysDate=function(){var t,e,o=new Date;t=Number((o.getDate()+1+"").substring(1,2))>0?o.getDate():"0"+o.getDate(),e=Number(o.getMonth()+1)>9?o.getMonth()+1:"0"+(o.getMonth()+1);var s=o.getFullYear();return this.today=s+"-"+e+"-"+t,this.today},t.prototype.displayMeal=function(t){this.selectedMeal=t},t.prototype.postFoodToBeRated=function(t){this.foodToBeRated=t},t.prototype.getFoodToBeRated=function(){return this.foodToBeRated},t.prototype.rateFood=function(t,e){var o={rank:t,food_id:e.id,user_id:parseInt(this.pService.currentProfileID)};return this.http.post(this.apiUrl+"canteen/send_rate/",o,this.httpNotGETOptions)},t.prototype.viewComboListContents=function(){this.showComboListContents=!0,this.showAddCombo=!1,this.showEditCombo=!1},t.prototype.viewAddCombo=function(){this.showComboListContents=!1,this.showAddCombo=!0,this.showEditCombo=!1},t.prototype.viewEditCombo=function(t){this.showComboListContents=!1,this.showAddCombo=!1,this.showEditCombo=!0,this.comboItemToBeEdited=t},t.prototype.getComboList=function(){return this.http.get(this.comboUrl,this.httpNotGETOptions)},t.prototype.getComboListItems=function(){var t=this;return this.getComboList().subscribe(function(e){t.comboItems=e,t.foodComboCount=0;for(var o=0;o<t.comboItems.length;o++)t.foodComboCount++;t.isLoaded=!0},function(e){switch(e.status){case 401:t.auth.refreshJWT()}})},t.prototype.createCombo=function(t,e,o){var s=this;this.pService.getItems(),this.pService.getData().subscribe(function(t){return s.company=t.company}),this.isUploading=!0;var i={image:e.split(",")[1],combo_items:o,name:t.name,unit_price:t.unit_price,unit_measure:t.unit_measure,category:parseInt(t.category),company:this.company};return console.log(i),this.http.post(r.a.apiUrl+"canteen/combo/",i,this.httpNotGETOptions).subscribe(function(t){s.isUploading=!1,alert("Food Combo: "+i.name+" created successfully."),s.getComboListItems(),s.viewComboListContents()},function(t){switch(console.log(t),s.isUploading=!1,t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),s.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}})},t.prototype.editCombo=function(t,e,o){var s=this;return this.isUploading=!0,this.http.patch(r.a.apiUrl+"canteen/combo/"+this.comboItemToBeEdited.id+"/",{name:t,unit_measure:e,unit_price:o},this.httpNotGETOptions).subscribe(function(e){s.isUploading=!1,alert("Food Combo: "+t+" edited successfully."),s.getComboListItems(),s.viewFoodListContents(),s.router.navigate(["food-combo"])},function(t){switch(s.isUploading=!1,t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),s.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}})},t.prototype.deleteCombo=function(t){var e=this;return this.isUploading=!0,this.http.delete(r.a.apiUrl+"canteen/combo/"+t.id+"/",this.httpNotGETOptions).subscribe(function(o){e.isUploading=!1,alert("Food Item: "+t.name+" deleted successfully."),e.getComboListItems()},function(t){switch(e.isUploading=!1,t.status){case 400:alert(c.a.e400);break;case 401:alert(c.a.e401),e.auth.refreshJWT();break;case 403:alert(c.a.e403);break;case 404:alert(c.a.e404);break;case 413:alert(c.a.e413);break;case 415:alert(c.a.e415);break;case 500:alert(c.a.e500);break;case 503:alert(c.a.e503)}})},t.ngInjectableDef=d.cc({factory:function(){return new t(d.dc(i.c),d.dc(n.a),d.dc(h.a),d.dc(a.a),d.dc(p.l))},token:t,providedIn:"root"}),t}()}}]);